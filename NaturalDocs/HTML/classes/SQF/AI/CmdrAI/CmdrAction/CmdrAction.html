<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CmdrAction</title><link rel="stylesheet" type="text/css" href="../../../../../styles/main.css" /><script type="text/javascript" src="../../../../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../../../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Topic192"></a><div class="CTopic TClass LSQF first">
 <div class="CTitle"><span class="Qualifier">AI.&#8203;CmdrAI.&#8203;CmdrAction.</span>&#8203;CmdrAction</div>
 <div class="CBody"><p>The base class for all commander actions. An Action is defined as any behaviour the commander can choose whether to perform.&nbsp; In general the actions are parameterized and scored based on relevance and the commanders current strategy.&nbsp; The scoring can be a complex as required, but in the end is reduced down to a single number that can be used in comparison between actions of the same type, and other types of the same priority level (see CmdrAI for how this works).&nbsp; The behaviour of the action is defined by a state machine, defined by a set of ActionStateTransitions and a set of associated variables (kind of like a blackboard system).&nbsp; Usually one or more pieces of intel will be associated with a CmdrAction to allow them to be discoverable by other commanders.</p><p>e.g. An action for a garrison to attack an outpost could be parameterized by the specific garrison and outpost, and scored based on how much the commander wants to control that outpost, how close the garrison is to it, and how well the garrison is predicted to do when fighting the enemy at the outpost.</p><p>Parent: &lt;RefCounted&gt;</p></div>
</div>

<a name="Functions"></a><a name="Topic193"></a><div class="CTopic TGroup LSQF">
 <div class="CTitle">Functions</div>
</div>

<a name="(protected)setScore"></a><a name="Topic194"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(protected) setScore</div>
 <div class="CBody"><p>Unpacks a score array (4 element number vector) into the individual scoring properties.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_scoreVec</td><td class="CDLDefinition"><p>Array of Number, the score vector to assign</p></td></tr></table></div>
</div>

<a name="(protected_virtual)createTransitions"></a><a name="Topic195"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(protected virtual) createTransitions</div>
 <div class="CBody"><p>Create the ASTs for the action and assign them to the transitions member variable.&nbsp; We do NOT do this in the constructor, because it is only required for actions that will definiely be used, and the vast majority of actions that are created are just speculative (they are scored and then discarded if the score is too low).</p></div>
</div>

<a name="registerGarrison"></a><a name="Topic196"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">registerGarrison</div>
 <div class="CBody"><p>Registers a garrison that has this action assigned to it, so we can automatically unassign this action from it when it is finished (helps with cleanup).</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_garrison</td><td class="CDLDefinition"><p>&lt;Model.GarrisonModel&gt;</p></td></tr></table></div>
</div>

<a name="unregisterGarrison"></a><a name="Topic197"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">unregisterGarrison</div>
 <div class="CBody"><p>Remove a garrison from the list for which we will automatically an assign this action when it is finished.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_garrison</td><td class="CDLDefinition"><p>&lt;Model.GarrisonModel&gt;</p></td></tr></table></div>
</div>

<a name="(protected)addGeneralIntelToGarrison"></a><a name="Topic198"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(protected) addGeneralIntelToGarrison</div>
 <div class="CBody"><p>Add the intel object of this action to a specific garrison.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_garrison</td><td class="CDLDefinition"><p>&lt;Model.GarrisonModel&gt;, the garrion to assign the intel to.</p></td></tr></table></div>
</div>

<a name="(protected)setPersonalGarrisonIntel"></a><a name="Topic199"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(protected) setPersonalGarrisonIntel</div>
</div>

<a name="(protected)addIntelAt"></a><a name="Topic200"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(protected) addIntelAt</div>
 <div class="CBody"><p>Add the intel object of this action to garrisons in an area specified.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_world</td><td class="CDLDefinition"><p><a href="../../../../../index.html#SQFClass:AI.CmdrAI.Model.WorldModel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,215);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Model.WorldModel</a>, the world model in which to look for garrisons.</p></td></tr><tr><td class="CDLEntry">_pos</td><td class="CDLDefinition"><p>Position, the center of the area in which we are placing intel.</p></td></tr><tr><td class="CDLEntry">_radius</td><td class="CDLDefinition"><p>Number, default 2000, the radius in meters in which we are placing intel.</p></td></tr></table></div>
</div>

<a name="updateIntelForEnemies"></a><a name="Topic201"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">updateIntelForEnemies</div>
 <div class="CBody"><p>Call this when we need to broadcast an intel update to enemies (enemy commanders)</p></div>
</div>

<a name="setIntelState"></a><a name="Topic202"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">setIntelState</div>
 <div class="CBody"><p>Sets the state of the intel associated with this action. Updates it for enemies, but only if state was changed.</p></div>
</div>

<a name="(virtual)updateScore"></a><a name="Topic203"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(virtual) updateScore</div>
 <div class="CBody"><p>Called by &lt;AI.CmdrAI.CmdrAI&gt; when evaluating potential actions. It should use the world states and settings this action was initialized with to evaluate its subjective value, and then set the score* member variables appropriately.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_worldNow</td><td class="CDLDefinition"><p><a href="../../../../../index.html#SQFClass:AI.CmdrAI.Model.WorldModel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,215);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Model.WorldModel</a>, simulation of world in its current state possibly with some instantaneous actions applied (e.g. resource allocation).</p></td></tr><tr><td class="CDLEntry">_worldFuture</td><td class="CDLDefinition"><p><a href="../../../../../index.html#SQFClass:AI.CmdrAI.Model.WorldModel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,215);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Model.WorldModel</a>, simulation of world in its predicted state once all currently planned actions are complete.</p></td></tr></table></div>
</div>

<a name="(protected)createVariable"></a><a name="Topic204"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(protected) createVariable</div>
 <div class="CBody"><p>Creates and registers an <a href="../../../../../index.html#SQFClass:AI.CmdrAI.CmdrAction.AST_VAR" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,168);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >AST_VAR</a> variable for use with this actions ASTs. The registration ensures that the value of the variable is saved and restored when performing simulations using this action. It is only required if the value can be changed by any of the ASTs themselves. If it can't then you can just directly create an <a href="../../../../../index.html#SQFClass:AI.CmdrAI.CmdrAction.AST_VAR" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,168);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >AST_VAR</a> without calling this function.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_initialValue</td><td class="CDLDefinition"><p>Any, initial value for the variable to hold.</p></td></tr></table><p>Returns: <a href="../../../../../index.html#SQFClass:AI.CmdrAI.CmdrAction.AST_VAR" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,168);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >AST_VAR</a> reference to the newly created and registered variable.</p></div>
</div>

<a name="applyToSim"></a><a name="Topic205"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">applyToSim</div>
 <div class="CBody"><p>Apply applicable ASTs to the specified world sim. What is applicable depends on current state, the type of world and the behaviour of the ASTs. Future world sims can have all ASTs applied until END state is reached, as ASTs should implement simulation of their final results. Now world sims can only have instantaneous AST results applied (e.g. allocating resources, splitting a Garrison, assigning an action), so will usually not transition to END state.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_world</td><td class="CDLDefinition"><p><a href="../../../../../index.html#SQFClass:AI.CmdrAI.Model.WorldModel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,215);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Model.WorldModel</a>, world to apply simulation of this action to. Sim worlds only, not real.</p></td></tr></table><p>Returns: <a href="../../../../../index.html#File:AI/Commander/CmdrAction/CmdrActionStates.hpp:AI.CmdrAI.CmdrAction.CMDR_ACTION_STATE" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,148);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >CMDR_ACTION_STATE</a>, the state after applying all applicable ASTs</p></div>
</div>

<a name="update"></a><a name="Topic206"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">update</div>
 <div class="CBody"><p>Attempt to progress with this action in a real world model.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_world</td><td class="CDLDefinition"><p><a href="../../../../../index.html#SQFClass:AI.CmdrAI.Model.WorldModel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,215);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Model.WorldModel</a>, real world to update this action for. Sim worlds are not valid.</p></td></tr></table></div>
</div>

<a name="cancel"></a><a name="Topic207"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">cancel</div>
 <div class="CBody"><p>Cancel this action while it is in progress.&nbsp; It will call a &quot;cancel&quot; on the current AST.</p></div>
</div>

<a name="isComplete"></a><a name="Topic208"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">isComplete</div>
 <div class="CBody"><p>Is this action complete? i.e. reached state <a href="../../../../../index.html#File:AI/Commander/CmdrAction/CmdrActionStates.hpp:AI.CmdrAI.CmdrAction.CMDR_ACTION_STATE.CMDR_ACTION_STATE_END" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,151);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >CMDR_ACTION_STATE.CMDR_ACTION_STATE_END</a> Returns: Boolean, true if the action is complete.</p></div>
</div>

<a name="(protected_virtual)updateIntel"></a><a name="Topic209"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(protected virtual) updateIntel</div>
 <div class="CBody"><p>Implement to update intel object.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_world</td><td class="CDLDefinition"><p><a href="../../../../../index.html#SQFClass:AI.CmdrAI.Model.WorldModel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,215);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Model.WorldModel</a>, real world model that is being used.</p></td></tr></table></div>
</div>

<a name="(protected_virtual)getLabel"></a><a name="Topic210"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(protected virtual) getLabel</div>
 <div class="CBody"><p>Implement to generate debug label for map marker for this action.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_world</td><td class="CDLDefinition"><p><a href="../../../../../index.html#SQFClass:AI.CmdrAI.Model.WorldModel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,215);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Model.WorldModel</a>, real world model that is being used.</p></td></tr></table></div>
</div>

<a name="(protected_virtual)debugDraw"></a><a name="Topic211"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(protected virtual) debugDraw</div>
 <div class="CBody"><p>Implement to perform debug drawing (e.g. update a marker).</p></div>
</div>

<a name="(static)calcDistanceFalloff"></a><a name="Topic212"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(static) calcDistanceFalloff</div>
 <div class="CBody"><p>Get a value that falls off from 1 to 0 with distance, scaled by k.&nbsp; 0m = 1, 2000m = 0.5, 4000m = 0.25, 6000m = 0.2, 10000m = 0.0385 See <a href="https://www.desmos.com/calculator/59i3cltsfr" target="_top">https://&#8203;www&#8203;.desmos&#8203;.com&#8203;/calculator&#8203;/59i3cltsfr</a></p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_from</td><td class="CDLDefinition"><p>Position, distance to calculate from</p></td></tr><tr><td class="CDLEntry">_to</td><td class="CDLDefinition"><p>Position, distance to calculate to</p></td></tr><tr><td class="CDLEntry">_k</td><td class="CDLDefinition"><p>Number, optional, factor that scales falloff amount, see description for examples.</p></td></tr></table><p>Returns: Number, value in 0 to 1 range representing the falloff that should be applied for the specified positions.</p></div>
</div>

<a name="(static)getDetachmentStrength"></a><a name="Topic213"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(static)getDetachmentStrength</div>
 <div class="CBody"><p>Returns number from given efficiency vector which represents how 'strong' the detachment is</p></div>
</div>

<a name="(virtual)getRecordSerial"></a><a name="Topic214"></a><div class="CTopic TFunction LSQF last">
 <div class="CTitle">(virtual) getRecordSerial</div>
 <div class="CBody"><p>Returns a serialized CmdrActionRecord associated with this action.&nbsp; Derived classes should implement this to have proper support for client's UI.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">_world</td><td class="CDLDefinition"><p><a href="../../../../../index.html#SQFClass:AI.CmdrAI.Model.WorldModel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,215);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Model.WorldModel</a>, real world model that is being used.</p></td></tr></table></div>
</div>

</body></html>