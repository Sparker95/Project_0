<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Action</title><link rel="stylesheet" type="text/css" href="../../styles/main.css" /><script type="text/javascript" src="../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Topic4"></a><div class="CTopic TClass LSQF first">
 <div class="CTitle">Action</div>
 <div class="CBody"><p>Action represents something which an agent can do over some period of time.&nbsp; Action can be in many states, see <a href="../../index.html#SQFClass:Action:ACTION_STATE" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ACTION_STATE</a>.</p><p>Based on source from &quot;Programming Game AI by Example&quot; by Mat Buckland: <a href="http://www.ai-junkie.com/books/toc_pgaibe.html" target="_top">http://&#8203;www&#8203;.ai-junkie&#8203;.com&#8203;/books&#8203;/toc_pgaibe&#8203;.html</a> In the book such a class was called Goal, however in our mission we call Goal another thing (<a href="../../index.html#SQFClass:Goal" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,307);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Goal</a>).&nbsp; I've added a few changes to Mat's architecture: in our mission there is a parallel composite Action.</p><p>There are also some methods which are needed for GOAP framework.</p><p>Note: If you need your Action to be compatible with GOAP action planner, then parameters must be an array of [tag, value] where tag can be a string or number</p><p>Author: Sparker 05.08.2018</p></div>
</div>

<a name="Variables"></a><a name="Topic5"></a><div class="CTopic TGroup LSQF">
 <div class="CTitle">Variables</div>
</div>

<a name="AI"></a><a name="Topic6"></a><div class="CTopic TVariable LSQF">
 <div class="CTitle">AI</div>
 <div class="CBody"><p>Holds a reference to <a href="../../index.html#SQFClass:Action:AI" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,6);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >AI</a> object which owns this action</p></div>
</div>

<a name="state"></a><a name="Topic7"></a><div class="CTopic TVariable LSQF">
 <div class="CTitle">state</div>
 <div class="CBody"><p>State of this action. Can be one of <a href="../../index.html#SQFClass:Action:ACTION_STATE" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ACTION_STATE</a></p></div>
</div>

<a name="timer"></a><a name="Topic8"></a><div class="CTopic TVariable LSQF">
 <div class="CTitle">timer</div>
 <div class="CBody"><p>holds a reference to timer which sends PROCESS messages to this Action, if it's autonomous</p></div>
</div>

<a name="(static)cost"></a><a name="Topic9"></a><div class="CTopic TVariable LSQF">
 <div class="CTitle">(static)cost</div>
</div>

<a name="Functions"></a><a name="Topic10"></a><div class="CTopic TGroup LSQF">
 <div class="CTitle">Functions</div>
</div>

<a name="new"></a><a name="Topic11"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">new</div>
 <div class="CBody"><p>Creates this action.</p><p>Parameters: _AI, _parameters</p><table class="CDefinitionList"><tr><td class="CDLEntry">_AI</td><td class="CDLDefinition"><p><a href="../../index.html#SQFClass:Action:AI" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,6);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >AI</a> of the agent</p></td></tr><tr><td class="CDLEntry">_parameters</td><td class="CDLDefinition"><p>Array of parameters. See note above about parameters.</p></td></tr></table></div>
</div>

<a name="delete"></a><a name="Topic12"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">delete</div>
</div>

<a name="setAutonomous"></a><a name="Topic13"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">setAutonomous</div>
 <div class="CBody"><p>Sets the goal to autonomous mode.&nbsp; Autonomous goals have a timer which generate a message to call the goal's process method.&nbsp; By default actions are processed in the process method of their AI (&lt;AI.process&gt;).</p><p>Parameters: _timerPeriod</p><table class="CDefinitionList"><tr><td class="CDLEntry">_timerPeriod</td><td class="CDLDefinition"><p>period between <a href="../../index.html#SQFClass:Action:process" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,18);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Action.process</a> calls in seconds</p></td></tr></table><p>Returns: nil</p></div>
</div>

<a name="handleMessage"></a><a name="Topic14"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">handleMessage</div>
 <div class="CBody"><p>See <a href="../../index.html#SQFClass:MessageReceiver:handleMessage" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,867);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MessageReceiver.handleMessage</a>.</p><p>Accepts message types:</p><table class="CDefinitionList"><tr><td class="CDLEntry">ACTION_MESSAGE_PROCESS</td><td class="CDLDefinition"><p>will call its &lt;Ation.process&gt; method.</p></td></tr><tr><td class="CDLEntry">ACTION_MESSAGE_DELETE</td><td class="CDLDefinition"><p>will delete this action.</p></td></tr></table><p>Returns: nil</p></div>
</div>

<a name="activateIfInactive"></a><a name="Topic15"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">activateIfInactive</div>
 <div class="CBody"><p>Calls the Activate method of this action if it's inactive.</p><p>Returns: Number, one of <a href="../../index.html#SQFClass:Action:ACTION_STATE" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ACTION_STATE</a>, the current state</p></div>
</div>

<a name="reactivateIfFailed"></a><a name="Topic16"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">reactivateIfFailed</div>
 <div class="CBody"><p>Calls the Activate method of this action if it's in failed state.</p><p>Returns: Number, one of <a href="../../index.html#SQFClass:Action:ACTION_STATE" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ACTION_STATE</a>, the current state</p></div>
</div>

<a name="activate"></a><a name="Topic17"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">activate</div>
 <div class="CBody"><p>Logic to run when the goal is activated. You should set the action state inside.</p><p>Returns: the current <a href="../../index.html#SQFClass:Action:ACTION_STATE" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ACTION_STATE</a></p></div>
</div>

<a name="process"></a><a name="Topic18"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">process</div>
 <div class="CBody"><p>Logic to run each update-step. Remember to set the state variable of the action here as well!</p><p>Returns: the current <a href="../../index.html#SQFClass:Action:ACTION_STATE" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ACTION_STATE</a></p></div>
</div>

<a name="terminate"></a><a name="Topic19"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">terminate</div>
 <div class="CBody"><p>logic to run when the goal is satisfied, or before it is deleted.</p><p>Returns: nil</p></div>
</div>

<a name="addSubactionToFront"></a><a name="Topic20"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">addSubactionToFront</div>
 <div class="CBody"><p>an Action is atomic and cannot aggregate subactions yet we must implement this method to provide the uniform interface required for the action hierarchy.</p><p>Returns: nil</p></div>
</div>

<a name="addSubactionToFront(2)"></a><a name="Topic21"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">addSubactionToFront</div>
 <div class="CBody"><p>an Action is atomic and cannot aggregate subactions yet we must implement this method to provide the uniform interface required for the action hierarchy.</p><p>Returns: nil</p></div>
</div>

<a name="getSubactions"></a><a name="Topic22"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">getSubactions</div>
 <div class="CBody"><p>Returns the list of subactions (for debug purposes).</p><p>Returns: []</p></div>
</div>

<a name="getFrontSubaction"></a><a name="Topic23"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">getFrontSubaction</div>
 <div class="CBody"><p>Returns this action. This function is here for common interface with ActionComposite.</p><p>Returns: _thisObject</p></div>
</div>

<a name="isCompleted"></a><a name="Topic24"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">isCompleted</div>
 <div class="CBody"><p>Returns: true if action is in completed state, false otherwise</p></div>
</div>

<a name="isActive"></a><a name="Topic25"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">isActive</div>
 <div class="CBody"><p>Returns: true if action is in active state, false otherwise</p></div>
</div>

<a name="isInactive"></a><a name="Topic26"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">isInactive</div>
 <div class="CBody"><p>Returns: true if action is in inactive state, false otherwise</p></div>
</div>

<a name="isFailed"></a><a name="Topic27"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">isFailed</div>
 <div class="CBody"><p>Returns: true if action is in failed state, false otherwise</p></div>
</div>

<a name="getCost"></a><a name="Topic28"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">getCost</div>
 <div class="CBody"><p>Returns the cost of taking this action in current situation By default it returns the value of &quot;cost&quot; static variable You can redefine it for inherited action if the returned cost needs to depend on something</p><p>Parameters: _AI, _wsStart, _wsEnd</p><table class="CDefinitionList"><tr><td class="CDLEntry">_AI</td><td class="CDLDefinition"><p>the <a href="../../index.html#SQFClass:Action:AI" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,6);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >AI</a> object</p></td></tr><tr><td class="CDLEntry">_wsStart</td><td class="CDLDefinition"><p>the start <a href="../../index.html#SQFClass:WorldState" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,425);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >WorldState</a></p></td></tr><tr><td class="CDLEntry">_wsEnd</td><td class="CDLDefinition"><p>the end <a href="../../index.html#SQFClass:WorldState" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,425);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >WorldState</a></p></td></tr></table><p>Returns: Number</p></div>
</div>

<a name="getPreconditions"></a><a name="Topic29"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">getPreconditions</div>
 <div class="CBody"><p>Returns preconditions of this action depending on parameters By default it tries to apply parameters to preconditions, if preconditions reference any parameters</p><p>Warning:If an action must provide preconditions which can't be copied from goal parameters, it must re-implement this method</p><p>Parameters: _goalParameters, _actionParameters</p><table class="CDefinitionList"><tr><td class="CDLEntry">_goalParameters</td><td class="CDLDefinition"><p>parameters of the <a href="../../index.html#SQFClass:Goal" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,307);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Goal</a> for which this action is considered</p></td></tr><tr><td class="CDLEntry">_actionParameters</td><td class="CDLDefinition"><p>parameters of this action resolved by the action planner _c -</p></td></tr></table><p>Returns: <a href="../../index.html#SQFClass:WorldState" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,425);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >WorldState</a></p></div>
</div>

<a name="getPrecedence"></a><a name="Topic30"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">getPrecedence</div>
 <div class="CBody"><p>Returns the precedence of this action.&nbsp; Actions executed first should have lower precedence.&nbsp; Precedence is only needed for actions that are used by planner.</p><p>Returns: Number</p></div>
</div>

<a name="(static)getParameterValue"></a><a name="Topic31"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">(static)getParameterValue</div>
 <div class="CBody"><p>Takes an array with parameters and returns value of parameter with given tag, or nil if such a parameter was not found.&nbsp; If the parameter is not found, it will diag_log an error message.</p><p>Parameters: _parameters, _tag</p><table class="CDefinitionList"><tr><td class="CDLEntry">_parameters</td><td class="CDLDefinition"><p>array with parameters</p></td></tr><tr><td class="CDLEntry">_tag</td><td class="CDLDefinition"><p>Number or String, parameter tag</p></td></tr><tr><td class="CDLEntry">_showError</td><td class="CDLDefinition"><p>Bool, default true, will show error if parameter with given tag is not found</p></td></tr></table><p>Returns: anything</p></div>
</div>

<a name="handleGroupsAdded"></a><a name="Topic32"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">handleGroupsAdded</div>
 <div class="CBody"><p>Override in your action to perform special handling of what happens when groups are added while your action is running.&nbsp; By default it doesn't do anything.</p><p>Parameters: _groups</p><table class="CDefinitionList"><tr><td class="CDLEntry">_groups</td><td class="CDLDefinition"><p>Array of <a href="../../index.html#SQFClass:Group" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,489);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Group</a></p></td></tr></table><p>Returns: nil</p></div>
</div>

<a name="handleGroupsRemoved"></a><a name="Topic33"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">handleGroupsRemoved</div>
 <div class="CBody"><p>Override in your action to perform special handling of what happens when groups are removed while your action is running.&nbsp; By default it doesn't do anything.</p><p>Parameters: _groups</p><table class="CDefinitionList"><tr><td class="CDLEntry">_groups</td><td class="CDLDefinition"><p>Array of <a href="../../index.html#SQFClass:Group" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,489);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Group</a></p></td></tr></table><p>Returns: nil</p></div>
</div>

<a name="handleUnitsRemoved"></a><a name="Topic34"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">handleUnitsRemoved</div>
 <div class="CBody"><p>Handles what happens when units get removed from their garrison, for instance when they gets destroyed, while this action is running.</p><p>Access: internal</p><p>Parameters: _units</p><table class="CDefinitionList"><tr><td class="CDLEntry">_units</td><td class="CDLDefinition"><p>Array of <a href="../../index.html#SQFClass:Unit" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,1015);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Unit</a> objects</p></td></tr></table><p>Returns: nil</p></div>
</div>

<a name="handleUnitsAdded"></a><a name="Topic35"></a><div class="CTopic TFunction LSQF">
 <div class="CTitle">handleUnitsAdded</div>
 <div class="CBody"><p>Handles what happens when units get added to a garrison while this action is running.</p><p>Access: internal</p><p>Parameters: _unit</p><table class="CDefinitionList"><tr><td class="CDLEntry">_units</td><td class="CDLDefinition"><p>Array of <a href="../../index.html#SQFClass:Unit" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,1015);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Unit</a> objects</p></td></tr></table><p>Returns: nil</p></div>
</div>

<a name="Types"></a><a name="Topic2"></a><div class="CTopic TGroup LSQF">
 <div class="CTitle">Types</div>
</div>

<a name="ACTION_STATE"></a><a name="Topic3"></a><div class="CTopic TEnumeration LSQF last">
 <div class="CTitle">ACTION_STATE</div>
 <div class="CBody"><p>These are possible action states</p><p>ACTION_STATE_ACTIVE - ACTION_STATE_INACTIVE - ACTION_STATE_COMPLETED - ACTION_STATE_FAILED -</p></div>
</div>

</body></html>